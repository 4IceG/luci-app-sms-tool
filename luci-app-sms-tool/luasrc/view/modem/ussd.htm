<%


-%>

<%+header%>
<h2><%:USSD%></h2>
	<label><%:Mini gui for handling ussd codes via sms_tool.%></label>
	<p></p>
	<h4><%:Sending USSD codes%></h4>


	<div class="table" width="100%">


		<div class="tr">
			<div class="td left" width="15%"><%:Sample codes%>:</div>

			<div class="td left" style="width:41%;">
				<select name="ussd" id="pl" onchange="copyFunction()">
  				<option value="*100#">Stan konta w sieci Plus</option>
  				<option value="*101#">Stan konta w sieci Play</option>
  				<option value="*136#">Stan pakietu internetowego w Premium Mobile</option>
  				<option value="*124*#">Stan konta w sieci Orange</option>
  				<option value="*101#">Stan konta w sieci T-Mobile</option>
 				</select>
			</div>
			<div class="td left" style="width:44%;"></div>
			</div>

		<div class="tr">
			<div class="td left" style="width:15%;"><%:Code to send%>:</div>
			<div class="td left" "><input type="text" id="code" required size="20"></div>

		</div>
		<div class="tr">
			<div class="td left" width="15%"><%:Reply%>:</div><div class="td left" id="odp"></div>

		</div>
	</div>

	<div class="table" width="100%">
		<div class="tr cbi-rowstyle-2">
		<div class="td center"><input type="button" id="sendussd" class="cbi-button" value="<%:Send Code%>" /></div>
		</div>
	</div>

<script type="text/javascript">//<![CDATA[

function copyFunction() {
  var x = document.getElementById("pl").value;
  document.getElementById("code").value = x;
  document.getElementById("odp").innerHTML = "";
}

function postcmd(cmd) {
    (new XHR()).post("<%=luci.dispatcher.build_url("admin", "modem", "sms", "run_ussd")%>", {"code":cmd}, function(x) {
        console.log(x.response)
        console.log(x)
        document.getElementById("odp").innerHTML = x.response;
    });
    return false;
}

document.addEventListener('DOMContentLoaded', function (ev) {var button = document.getElementById("sendussd");
        button.addEventListener("click", function () {


		var s = document.getElementById("code").value;
		if ( s.length == 0 )
		{
  			document.getElementById("odp").innerHTML = "";
			alert("<%:You must enter a ussd code!%>");
			return false;
		}

        var cmd = document.getElementById("code");
        postcmd(cmd.value);
        cmd.value = "";
        return true;
        });
    }, true);


//]]></script>

<%+footer%>
